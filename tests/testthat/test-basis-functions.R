test_that("radial basis functions are correctly computed", {
  correct_rbf = structure(
    c(
      1, 0.923116346386636, 0.726149037073691, 0.486752255959972, 
      0.278037300453194, 0.135335283236613, 0.0561347628341337, 
      0.0198410947443703, 0.00597602289500594, 0.00153381067932446, 
      0.486752255959972, 0.726149037073691, 0.923116346386636, 1, 
      0.923116346386636, 0.726149037073691, 0.486752255959972, 
      0.278037300453194, 0.135335283236613, 0.0561347628341337, 
      0.0561347628341337, 0.135335283236613, 0.278037300453194, 
      0.486752255959972, 0.726149037073691, 0.923116346386636, 1, 
      0.923116346386636, 0.726149037073691, 0.486752255959972, 
      0.00153381067932446, 0.00597602289500594, 0.0198410947443703, 
      0.0561347628341337, 0.135335283236613, 0.278037300453194, 
      0.486752255959972, 0.726149037073691, 0.923116346386636, 1
    )
    , dim = c(10L, 4L)
  )
  expect_equal(rbf(10, 4), correct_rbf)
})
