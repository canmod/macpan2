<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Join Indexes — mp_join • macpan2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Join Indexes — mp_join"><meta name="description" content="Join two or more index tables (see mp_index) to produce a
ledger (see LedgerDefinition)."><meta property="og:description" content="Join two or more index tables (see mp_index) to produce a
ledger (see LedgerDefinition)."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">macpan2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.16.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/quickstart.html">Quickstart</a></li>
    <li><a class="dropdown-item" href="../articles/example_models.html">Example Models</a></li>
    <li><a class="dropdown-item" href="../articles/calibration.html">Calibrating Compartmental Models to Data</a></li>
    <li><a class="dropdown-item" href="../articles/real_data.html">Fitting to Real Data</a></li>
    <li><a class="dropdown-item" href="../articles/state_updaters.html">ODE Solvers, Process Error, and Difference Equations</a></li>
    <li><a class="dropdown-item" href="../articles/options.html">Options</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/canmod/macpan2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Join Indexes</h1>
      <small class="dont-index">Source: <a href="https://github.com/canmod/macpan2/blob/main/R/mp_join.R" class="external-link"><code>R/mp_join.R</code></a></small>
      <div class="d-none name"><code>mp_join.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Join two or more index tables (see <code><a href="mp_index.html">mp_index</a></code>) to produce a
ledger (see <code><a href="LedgerDefinition.html">LedgerDefinition</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mp_join</span><span class="op">(</span><span class="va">...</span>, by <span class="op">=</span> <span class="fu">empty_named_list</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Named arguments giving indexes created by
<code><a href="mp_index.html">mp_index</a></code> or another function that manipulates indexes.
Each argument will become a position vector used to subset
or expand numeric vectors in archetype formulas.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>What columns to use to join the indexes. See below on
how to specify this argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When two index tables are passed to <code>...</code>, <code>mp_join</code> behaves very much like
an ordinary <a href="https://en.wikipedia.org/wiki/Join_(SQL)" class="external-link">inner join</a>.
When more than two tables are passed to <code>...</code>, <code>mp_join</code> iteratively joins
pairs of tables to produce a final ledger. For example, if index tables <code>A</code>
<code>B</code>, and <code>C</code> are passed to <code>mp_join</code>, an inner join of <code>A</code> and <code>B</code> is
performed and the result is joined with <code>C</code>. In each of these successive
internal joins. The properties of inner
joins ensures that the order of tables does not affect the set of rows in
the final table (SW states without proof!).</p>
<p>When two index tables are passed to <code>...</code>, the <code>by</code> argument is just a
character vector of column names on which to join (as in standard R functions
for joining data frames), or the dot-concatenation of these column names.
For example,</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">state</span> <span class="op">=</span> <span class="fu"><a href="../reference/mp_index.html">mp_index</a></span><span class="op">(</span></span>
<span>  Epi <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"S"</span>, <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  Age <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"young"</span>, <span class="st">"young"</span>, <span class="st">"old"</span>, <span class="st">"old"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mp_join.html">mp_join</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"Age"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     from      to</span></span>
<span><span class="co">#&gt;  S.young I.young</span></span>
<span><span class="co">#&gt;    S.old   I.old</span></span></code></pre><p></p></div>
<p>If there are more than two tables then the <code>by</code> argument must be a named
list of character vectors, each describing how to join the columns of
a pair of tables in <code>...</code>. The names of this list are dot-concatenations
of the names of pairs of tables in <code>...</code>. For example,</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">rates</span> <span class="op">=</span> <span class="fu"><a href="../reference/mp_index.html">mp_index</a></span><span class="op">(</span></span>
<span>  Epi <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span>, <span class="st">"lambda"</span><span class="op">)</span>,</span>
<span>  Age <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"young"</span>, <span class="st">"old"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mp_join.html">mp_join</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">rates</span>, Epi <span class="op">=</span> <span class="st">"lambda"</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    from.to <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>    from.rate <span class="op">=</span> <span class="st">"Age"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     from      to         rate</span></span>
<span><span class="co">#&gt;  S.young I.young lambda.young</span></span>
<span><span class="co">#&gt;    S.old   I.old   lambda.old</span></span></code></pre><p></p></div>
<p>If the <code>by</code> columns have different names in two tables, then you can
specify these using formula notation where the left-hand-side
is a dot-concatenation of columns in the first table and the
right-hand-side is a dot-concatenation of the columns in the second
table. For example,</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">contact</span> <span class="op">=</span> <span class="fu"><a href="../reference/mp_index.html">mp_index</a></span><span class="op">(</span></span>
<span>  AgeSusceptible <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"young"</span>, <span class="st">"young"</span>, <span class="st">"old"</span>, <span class="st">"old"</span><span class="op">)</span>,</span>
<span>  AgeInfectious <span class="op">=</span> <span class="fu"><a href="../reference/engine_functions.html">c</a></span><span class="op">(</span><span class="st">"young"</span>, <span class="st">"old"</span>, <span class="st">"young"</span>, <span class="st">"old"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mp_join.html">mp_join</a></span><span class="op">(</span></span>
<span>  sus <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"S"</span><span class="op">)</span>,</span>
<span>  inf <span class="op">=</span> <span class="fu"><a href="../reference/mp_subset.html">mp_subset</a></span><span class="op">(</span><span class="va">state</span>, Epi <span class="op">=</span> <span class="st">"I"</span><span class="op">)</span>,</span>
<span>  con <span class="op">=</span> <span class="va">contact</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    sus.con <span class="op">=</span> <span class="st">"Age"</span> <span class="op">~</span> <span class="st">"AgeSusceptible"</span>,</span>
<span>    inf.con <span class="op">=</span> <span class="st">"Age"</span> <span class="op">~</span> <span class="st">"AgeInfectious"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;      sus     inf         con</span></span>
<span><span class="co">#&gt;  S.young I.young young.young</span></span>
<span><span class="co">#&gt;    S.old I.young   old.young</span></span>
<span><span class="co">#&gt;  S.young   I.old   young.old</span></span>
<span><span class="co">#&gt;    S.old   I.old     old.old</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions that return ledgers
<code><a href="mp_aggregate.html">mp_aggregate</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steve Walker, Weiguang Guan, Jen Freeman, Ben Bolker, Darren Flynn-Primrose.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

