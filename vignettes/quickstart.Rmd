---
title: "Quickstart"
output: 
  html_document:
    toc: true
    keep_md: yes
vignette: >
  %\VignetteIndexEntry{Quickstart}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

[![status](https://img.shields.io/badge/status-working%20draft-red)](https://canmod.github.io/macpan2/articles/vignette-status#working-draft)

```{r setup, echo = FALSE, message = FALSE, warning = FALSE}
library(macpan2)
library(ggplot2)
library(dplyr)
```

The following code specifies an SI model, which is I think is the simplest possible model of epidemiological transmission.
```{r hello-world}
si = mp_tmb_model_spec(
    before = list(
        I ~ 1
      , S ~ N - I
    )
  , during = list(
        infection ~ beta * S * I / N
      , S ~ S - infection
      , I ~ I + infection
    )
  , default = list(N = 100, beta = 0.25)
)
print(si)
```

Simulating from this model requires choosing the number of time-steps to run and the model outputs to generate. Syntax for simulating `macpan2` models is designed to combine with standard data prep and plotting tools in R, as we demonstrate with the following code.
```{r plot-tmb-si, fig.format='svg'}
(si
 |> mp_simulator(time_steps = 50, outputs = c("I", "infection"))
 |> mp_trajectory()
 |> mutate(quantity = case_match(matrix
    , "I" ~ "Prevalance"
    , "infection" ~ "Incidence"
  ))
 |> ggplot() 
 + geom_line(aes(time, value)) 
 + facet_wrap(~ quantity, scales = "free")
 + theme_bw()
)
```


## TODO

* Bring over from previous quickstart on `main`, which currently [here](https://canmod.github.io/macpan2/articles/quickstart)
    * explanation of modelling output and philosophy of post-processing
    * Modify [this](https://canmod.github.io/macpan2/articles/quickstart.html#inputting-values-to-create-model-simulators) so that it works with `default` value updates using `mp_tmb_simulator`
    * Modify [this](https://canmod.github.io/macpan2/articles/quickstart.html#incidence) discussion of incidence
